package com.cpitoedifact.converter;

import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

/**
 * Test to verify XML to EDIFACT conversion works correctly.
 */
public class XmlToEdifactTest {
    
    @Test
    public void testXmlToEdifactConversion() throws Exception {
        CPIEdifactConverter converter = new CPIEdifactConverter();
        
        String xmlInput = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n" +
"<INTERCHANGE>\n" +
"<S_UNB>\n" +
"<C_S001>\n" +
"<D_0001>UNOC</D_0001>\n" +
"<D_0002>3</D_0002>\n" +
"</C_S001>\n" +
"<C_S002>\n" +
"<D_0004>SENDER ID</D_0004>\n" +
"<D_0007>ZZZ</D_0007>\n" +
"<D_0008>A1B2C3D4E5</D_0008>\n" +
"</C_S002>\n" +
"<C_S003>\n" +
"<D_0010>RECEIVER ID</D_0010>\n" +
"<D_0007>ZZZ</D_0007>\n" +
"<D_0014>A1B2C3D4E5</D_0014>\n" +
"</C_S003>\n" +
"<C_S004>\n" +
"<D_0017>20151128</D_0017>\n" +
"<D_0019>1037</D_0019>\n" +
"</C_S004>\n" +
"<D_0020>1</D_0020>\n" +
"<C_S005/>\n" +
"<D_0026/>\n" +
"<D_0029/>\n" +
"<D_0031>1</D_0031>\n" +
"<D_0032/>\n" +
"<D_0035>1</D_0035>\n" +
"</S_UNB>\n" +
"<M_ORDERS>\n" +
"<S_UNH>\n" +
"<D_0062>1</D_0062>\n" +
"<C_S009>\n" +
"<D_0065>ORDERS</D_0065>\n" +
"<D_0052>D</D_0052>\n" +
"<D_0054>01B</D_0054>\n" +
"<D_0051>UN</D_0051>\n" +
"<D_0057>EAN010</D_0057>\n" +
"</C_S009>\n" +
"</S_UNH>\n" +
"<S_BGM>\n" +
"<C_C002>\n" +
"<D_1001>220</D_1001>\n" +
"</C_C002>\n" +
"<C_C106>\n" +
"<D_1004>PO357893</D_1004>\n" +
"</C_C106>\n" +
"<D_1225>9</D_1225>\n" +
"</S_BGM>\n" +
"<S_DTM>\n" +
"<C_C507>\n" +
"<D_2005>2</D_2005>\n" +
"<D_2380>20150813</D_2380>\n" +
"<D_2379>102</D_2379>\n" +
"</C_C507>\n" +
"</S_DTM>\n" +
"<S_DTM>\n" +
"<C_C507>\n" +
"<D_2005>137</D_2005>\n" +
"<D_2380>201511281130</D_2380>\n" +
"<D_2379>203</D_2379>\n" +
"</C_C507>\n" +
"</S_DTM>\n" +
"<S_DTM>\n" +
"<C_C507>\n" +
"<D_2005>235</D_2005>\n" +
"<D_2380>201509071025</D_2380>\n" +
"<D_2379>203</D_2379>\n" +
"</C_C507>\n" +
"</S_DTM>\n" +
"<S_FTX>\n" +
"<D_4451>DEL</D_4451>\n" +
"<D_4453>1</D_4453>\n" +
"<C_C107/>\n" +
"<C_C108>\n" +
"<D_4440>INCLUDE TIME IN DATE OF DELIVERY</D_4440>\n" +
"</C_C108>\n" +
"</S_FTX>\n" +
"<G_SG1>\n" +
"<S_RFF>\n" +
"<C_C506>\n" +
"<D_1153>AAN</D_1153>\n" +
"<D_1154>APPTNO123445</D_1154>\n" +
"</C_C506>\n" +
"</S_RFF>\n" +
"</G_SG1>\n" +
"<G_SG2>\n" +
"<S_NAD>\n" +
"<D_3035>BY</D_3035>\n" +
"<C_C082>\n" +
"<D_3039>BUYEREANID12345</D_3039>\n" +
"<D_1131/>\n" +
"<D_3055>9</D_3055>\n" +
"</C_C082>\n" +
"</S_NAD>\n" +
"<S_LOC>\n" +
"<D_3227>7</D_3227>\n" +
"<C_C517>\n" +
"<D_3225>BUYERPLACE</D_3225>\n" +
"<D_1131/>\n" +
"<D_3055>92</D_3055>\n" +
"</C_C517>\n" +
"</S_LOC>\n" +
"<G_SG5>\n" +
"<S_CTA>\n" +
"<D_3139>PD</D_3139>\n" +
"<C_C056>\n" +
"<D_3413>A1B2C3D4E5</D_3413>\n" +
"<D_3412>A1B2C3D4E5</D_3412>\n" +
"</C_C056>\n" +
"</S_CTA>\n" +
"<S_COM>\n" +
"<C_C076>\n" +
"<D_3148>EMAIL@DOMAIN</D_3148>\n" +
"<D_3155>EM</D_3155>\n" +
"</C_C076>\n" +
"</S_COM>\n" +
"<S_COM>\n" +
"<C_C076>\n" +
"<D_3148>9055557766</D_3148>\n" +
"<D_3155>FX</D_3155>\n" +
"</C_C076>\n" +
"</S_COM>\n" +
"</G_SG5>\n" +
"</G_SG2>\n" +
"<G_SG2>\n" +
"<S_NAD>\n" +
"<D_3035>ST</D_3035>\n" +
"<C_C082>\n" +
"<D_3039>SHIPTOEANID3457</D_3039>\n" +
"<D_1131/>\n" +
"<D_3055>9</D_3055>\n" +
"</C_C082>\n" +
"</S_NAD>\n" +
"<S_LOC>\n" +
"<D_3227>7</D_3227>\n" +
"<C_C517>\n" +
"<D_3225>SHIPTOLOCATION</D_3225>\n" +
"<D_1131/>\n" +
"<D_1131/>\n" +
"<D_3055>92</D_3055>\n" +
"</C_C517>\n" +
"</S_LOC>\n" +
"<G_SG5>\n" +
"<S_CTA>\n" +
"<D_3139>PD</D_3139>\n" +
"<C_C056>\n" +
"<D_3413>A1B2C3D4E5</D_3413>\n" +
"<D_3412>A1B2C3D4E5</D_3412>\n" +
"</C_C056>\n" +
"</S_CTA>\n" +
"<S_COM>\n" +
"<C_C076>\n" +
"<D_3148>8185556789</D_3148>\n" +
"<D_3155>FX</D_3155>\n" +
"</C_C076>\n" +
"</S_COM>\n" +
"<S_COM>\n" +
"<C_C076>\n" +
"<D_3148>2135559898</D_3148>\n" +
"<D_3155>TE</D_3155>\n" +
"</C_C076>\n" +
"</S_COM>\n" +
"</G_SG5>\n" +
"</G_SG2>\n" +
"<G_SG2>\n" +
"<S_NAD>\n" +
"<D_3035>SU</D_3035>\n" +
"<C_C082>\n" +
"<D_3039>SUPPLIEREANID9876</D_3039>\n" +
"<D_1131/>\n" +
"<D_3055>9</D_3055>\n" +
"</C_C082>\n" +
"</S_NAD>\n" +
"<S_LOC>\n" +
"<D_3227>7</D_3227>\n" +
"<C_C517>\n" +
"<D_3225>SUPPLIERLOCATION</D_3225>\n" +
"<D_1131/>\n" +
"<D_3055>92</D_3055>\n" +
"</C_C517>\n" +
"</S_LOC>\n" +
"<G_SG5>\n" +
"<S_CTA>\n" +
"<D_3139>PD</D_3139>\n" +
"<C_C056>\n" +
"<D_3413>A1B2C3D4E5</D_3413>\n" +
"<D_3412>A1B2C3D4E5</D_3412>\n" +
"</C_C056>\n" +
"</S_CTA>\n" +
"<S_COM>\n" +
"<C_C076>\n" +
"<D_3148>SALES@DOMAIN</D_3148>\n" +
"<D_3155>EM</D_3155>\n" +
"</C_C076>\n" +
"</S_COM>\n" +
"<S_COM>\n" +
"<C_C076>\n" +
"<D_3148>3105553344</D_3148>\n" +
"<D_3155>TE</D_3155>\n" +
"</C_C076>\n" +
"</S_COM>\n" +
"</G_SG5>\n" +
"</G_SG2>\n" +
"<G_SG28>\n" +
"<S_LIN>\n" +
"<D_1082>1</D_1082>\n" +
"<D_1229>1</D_1229>\n" +
"<C_C212>\n" +
"<D_7140>GTIN1233456</D_7140>\n" +
"<D_7143>SRV</D_7143>\n" +
"</C_C212>\n" +
"</S_LIN>\n" +
"<S_PIA>\n" +
"<D_4347>5</D_4347>\n" +
"<C_C212>\n" +
"<D_7140>VDKF9T</D_7140>\n" +
"<D_7143>IN</D_7143>\n" +
"</C_C212>\n" +
"<C_C212>\n" +
"<D_7140>ERG34T2233</D_7140>\n" +
"<D_7143>IN</D_7143>\n" +
"</C_C212>\n" +
"</S_PIA>\n" +
"<S_IMD>\n" +
"<D_7077>F</D_7077>\n" +
"<C_C272>\n" +
"<D_7081/>\n" +
"</C_C272>\n" +
"<C_C273>\n" +
"<D_7009/>\n" +
"<D_1131/>\n" +
"<D_3055/>\n" +
"<D_7008>PRODUCT 1</D_7008>\n" +
"</C_C273>\n" +
"</S_IMD>\n" +
"<S_MEA>\n" +
"<D_6311>PD</D_6311>\n" +
"<C_C502>\n" +
"<D_6313>ULY</D_6313>\n" +
"</C_C502>\n" +
"<C_C174>\n" +
"<D_6411>NAR</D_6411>\n" +
"<D_6314>24</D_6314>\n" +
"</C_C174>\n" +
"</S_MEA>\n" +
"<S_QTY>\n" +
"<C_C186>\n" +
"<D_6063>21</D_6063>\n" +
"<D_6060>45</D_6060>\n" +
"<D_6411>KGM</D_6411>\n" +
"</C_C186>\n" +
"</S_QTY>\n" +
"<S_DTM>\n" +
"<C_C507>\n" +
"<D_2005>364</D_2005>\n" +
"<D_2380>20151217</D_2380>\n" +
"<D_2379>102</D_2379>\n" +
"</C_C507>\n" +
"</S_DTM>\n" +
"<G_SG32>\n" +
"<S_PRI>\n" +
"<C_C509>\n" +
"<D_5125>1E</D_5125>\n" +
"<D_5118>190.45</D_5118>\n" +
"</C_C509>\n" +
"</S_PRI>\n" +
"</G_SG32>\n" +
"</G_SG28>\n" +
"<G_SG28>\n" +
"<S_LIN>\n" +
"<D_1082>2</D_1082>\n" +
"<D_1229>1</D_1229>\n" +
"<C_C212>\n" +
"<D_7140>GTIN8734652</D_7140>\n" +
"<D_7143>SRV</D_7143>\n" +
"</C_C212>\n" +
"</S_LIN>\n" +
"<S_PIA>\n" +
"<D_4347>5</D_4347>\n" +
"<C_C212>\n" +
"<D_7140>LKKSDFK56324</D_7140>\n" +
"<D_7143>SA</D_7143>\n" +
"</C_C212>\n" +
"<C_C212>\n" +
"<D_7140>K3IF5N58FN4</D_7140>\n" +
"<D_7143>SA</D_7143>\n" +
"</C_C212>\n" +
"</S_PIA>\n" +
"<S_IMD>\n" +
"<D_7077>F</D_7077>\n" +
"<C_C272>\n" +
"<D_7081/>\n" +
"</C_C272>\n" +
"<C_C273>\n" +
"<D_7009/>\n" +
"<D_1131/>\n" +
"<D_3055/>\n" +
"<D_7008>THIS IS PRODUCT2</D_7008>\n" +
"</C_C273>\n" +
"</S_IMD>\n" +
"<S_MEA>\n" +
"<D_6311>PD</D_6311>\n" +
"<C_C502>\n" +
"<D_6313>LAY</D_6313>\n" +
"</C_C502>\n" +
"<C_C174>\n" +
"<D_6411>NAR</D_6411>\n" +
"<D_6314>6</D_6314>\n" +
"</C_C174>\n" +
"</S_MEA>\n" +
"<S_QTY>\n" +
"<C_C186>\n" +
"<D_6063>59</D_6063>\n" +
"<D_6060>3</D_6060>\n" +
"<D_6411>KGM</D_6411>\n" +
"</C_C186>\n" +
"</S_QTY>\n" +
"<S_DTM>\n" +
"<C_C507>\n" +
"<D_2005>364</D_2005>\n" +
"<D_2380>20090716</D_2380>\n" +
"<D_2379>102</D_2379>\n" +
"</C_C507>\n" +
"</S_DTM>\n" +
"<G_SG32>\n" +
"<S_PRI>\n" +
"<C_C509>\n" +
"<D_5125>1E</D_5125>\n" +
"<D_5118>123456.50</D_5118>\n" +
"</C_C509>\n" +
"</S_PRI>\n" +
"</G_SG32>\n" +
"</G_SG28>\n" +
"<S_UNS>\n" +
"<D_0081>S</D_0081>\n" +
"</S_UNS>\n" +
"<S_MOA>\n" +
"<C_C516>\n" +
"<D_5025>86</D_5025>\n" +
"<D_5004>37535.34</D_5004>\n" +
"</C_C516>\n" +
"</S_MOA>\n" +
"<S_CNT>\n" +
"<C_C270>\n" +
"<D_6069>2</D_6069>\n" +
"<D_6066>2</D_6066>\n" +
"</C_C270>\n" +
"</S_CNT>\n" +
"<S_UNT>\n" +
"<D_0074>40</D_0074>\n" +
"<D_0062>1</D_0062>\n" +
"</S_UNT>\n" +
"</M_ORDERS>\n" +
"<S_UNZ>\n" +
"<D_0036>1</D_0036>\n" +
"<D_0020>1</D_0020>\n" +
"</S_UNZ>\n" +
"</INTERCHANGE>";
        
        System.out.println("Converting XML to EDIFACT...");
        String edifactResult = converter.convertXmlToEdifact(xmlInput);
        
        System.out.println("EDIFACT Result:");
        System.out.println(edifactResult);
        
        assertNotNull(edifactResult, "EDIFACT result should not be null");
        assertTrue(edifactResult.length() > 0, "EDIFACT result should not be empty");
        assertTrue(edifactResult.contains("UNB"), "Should contain UNB segment");
        assertTrue(edifactResult.contains("UNH"), "Should contain UNH segment");
        assertTrue(edifactResult.contains("BGM"), "Should contain BGM segment");
        assertTrue(edifactResult.contains("UNT"), "Should contain UNT segment");
        assertTrue(edifactResult.contains("UNZ"), "Should contain UNZ segment");
    }
}
